2025-08-23 14:50:18,152 INFO: üéØ TASK STARTED: start_lesson_generation_task for user demo-user, subject 'custom_therapy_demo-user' at 2025-08-23 14:50:18.152153 [in /app/app/services/background_tasks.py:175]
2025-08-23 14:50:18,212 INFO: üìä SUBMISSION DATA: {
  "user_id": "demo-user",
  "subject": "custom_therapy_demo-user",
  "answers": [
    {
      "question_id": 1,
      "answer": 4,
      "question": "What is your current experience level with Custom Learning Path?",
      "selected_option": {
        "label": "I'm not sure / Don't know",
        "value": "option_5"
      }
    },
    {
      "question_id": 2,
      "answer": 4,
      "question": "What do you want to achieve with Custom Learning Path?",
      "selected_option": {
        "label": "I'm not sure / Don't know",
        "value": "option_5"
      }
    },
    {
      "question_id": 3,
      "answer": 4,
      "question": "How much time can you dedicate to learning per week?",
      "selected_option": {
        "label": "I'm not sure / Don't know",
        "value": "option_5"
      }
    },
    {
      "question_id": 4,
      "answer": 4,
      "question": "What is your preferred learning approach for Custom Learning Path?",
      "selected_option": {
        "label": "I'm not sure / Don't know",
        "value": "option_5"
      }
    }
  ],
  "submitted_at": "2025-08-23T14:50:18.062883",
  "status": "submitted"
} [in /app/app/services/background_tasks.py:176]
2025-08-23 14:50:18,216 INFO: üîç TASK METADATA: ID=ad8ae45d-55ef-4c4c-bfb8-8a78dad780fb, retries=0, eta=None [in /app/app/services/background_tasks.py:180]
2025-08-23 14:50:18,218 INFO: üì¶ IMPORTING SERVICES... [in /app/app/services/background_tasks.py:183]
2025-08-23 14:50:18,219 INFO: ‚úÖ SERVICES IMPORTED SUCCESSFULLY [in /app/app/services/background_tasks.py:188]
2025-08-23 14:50:18,221 INFO: üìù PROCESSING SURVEY ANSWERS for user demo-user, subject 'custom_therapy_demo-user' [in /app/app/services/background_tasks.py:191]
2025-08-23 14:50:18,223 INFO: üìã FOUND 4 SURVEY ANSWERS: [{'question_id': 1, 'answer': 4, 'question': 'What is your current experience level with Custom Learning Path?', 'selected_option': {'label': "I'm not sure / Don't know", 'value': 'option_5'}}, {'question_id': 2, 'answer': 4, 'question': 'What do you want to achieve with Custom Learning Path?', 'selected_option': {'label': "I'm not sure / Don't know", 'value': 'option_5'}}, {'question_id': 3, 'answer': 4, 'question': 'How much time can you dedicate to learning per week?', 'selected_option': {'label': "I'm not sure / Don't know", 'value': 'option_5'}}, {'question_id': 4, 'answer': 4, 'question': 'What is your preferred learning approach for Custom Learning Path?', 'selected_option': {'label': "I'm not sure / Don't know", 'value': 'option_5'}}] [in /app/app/services/background_tasks.py:193]
2025-08-23 14:50:18,229 INFO: üíæ SURVEY ANSWERS SAVED TO: /app/survey_answers.json [in /app/app/services/background_tasks.py:207]
2025-08-23 14:50:18,231 INFO: üîÑ CALLING SurveyAnalysisService.process_survey_answers... [in /app/app/services/background_tasks.py:211]
2025-08-23 14:50:18,233 INFO: Processing survey answers for user demo-user, subject custom_therapy_demo-user [in /app/app/services/survey_analysis_service.py:50]
2025-08-23 14:50:18,249 INFO: Found 'don't know' response: '{'value': 'option_5', 'label': "I'm not sure / Don't know"}' - setting skill level to beginner [in /app/app/services/survey_analysis_service.py:258]
2025-08-23 14:50:18,263 INFO: Saved survey analysis results to users/demo-user/custom_therapy_demo-user/survey_answers.json [in /app/app/services/survey_analysis_service.py:362]
2025-08-23 14:50:18,278 INFO: Updating existing survey result for demo-user - custom_therapy_demo-user [in /app/app/services/survey_result_service.py:23]
2025-08-23 14:50:18,281 INFO: Updated survey result: demo-user - custom_therapy_demo-user [in /app/app/services/survey_result_service.py:86]
2025-08-23 14:50:18,283 INFO: Stored survey result in database: demo-user - custom_therapy_demo-user - beginner [in /app/app/services/survey_analysis_service.py:167]
2025-08-23 14:50:18,285 INFO: Survey analysis completed for demo-user, skill level: beginner [in /app/app/services/survey_analysis_service.py:172]
2025-08-23 14:50:18,286 INFO: ‚úÖ SURVEY ANALYSIS COMPLETED: {
  "user_id": "demo-user",
  "subject": "custom_therapy_demo-user",
  "processed_at": "2025-08-23T14:50:18.251063",
  "total_questions": 4,
  "correct_answers": 0,
  "accuracy": 0.0,
  "weighted_accuracy": 0,
  "skill_level": "beginner",
  "performance_by_difficulty": {
    "beginner": {
      "correct": 0,
      "total": 0
    },
    "intermediate": {
      "correct": 0,
      "total": 0
    },
    "advanced": {
      "correct": 0,
      "total": 0
    }
  },
  "topic_analysis": {
    "strengths": [],
    "weaknesses": [
      "general"
    ],
    "topic_scores": {
      "general": {
        "accuracy": 0.0,
        "correct": 0,
        "total": 4
      }
    }
  },
  "processed_answers": [
    {
      "question_id": 1,
      "question": "What is your current experience level with Custom Learning Path?",
      "user_answer": 4,
      "user_answer_text": "{'value': 'option_5', 'label': \"I'm not sure / Don't know\"}",
      "correct_answer": null,
      "is_correct": false,
      "difficulty": "intermediate",
      "topic": "general",
      "weight": 1.5
    },
    {
      "question_id": 2,
      "question": "What do you want to achieve with Custom Learning Path?",
      "user_answer": 4,
      "user_answer_text": "{'value': 'option_5', 'label': \"I'm not sure / Don't know\"}",
      "correct_answer": null,
      "is_correct": false,
      "difficulty": "intermediate",
      "topic": "general",
      "weight": 1.5
    },
    {
      "question_id": 3,
      "question": "How much time can you dedicate to learning per week?",
      "user_answer": 4,
      "user_answer_text": "{'value': 'option_5', 'label': \"I'm not sure / Don't know\"}",
      "correct_answer": null,
      "is_correct": false,
      "difficulty": "intermediate",
      "topic": "general",
      "weight": 1.5
    },
    {
      "question_id": 4,
      "question": "What is your preferred learning approach for Custom Learning Path?",
      "user_answer": 4,
      "user_answer_text": "{'value': 'option_5', 'label': \"I'm not sure / Don't know\"}",
      "correct_answer": null,
      "is_correct": false,
      "difficulty": "intermediate",
      "topic": "general",
      "weight": 1.5
    }
  ],
  "recommendations": [
    "Focus on fundamental concepts and basic syntax",
    "Practice with simple exercises and examples",
    "Review and practice: general"
  ]
} [in /app/app/services/background_tasks.py:215]
2025-08-23 14:50:18,287 INFO: üîç GETTING SUBJECT INFO for 'custom_therapy_demo-user' [in /app/app/services/background_tasks.py:218]
2025-08-23 14:50:18,291 INFO: üìä SUBJECT INFO: {'id': 'custom_therapy_demo-user', 'name': 'Therapy Demo-User', 'description': 'Custom subject created by user', 'is_custom': True} [in /app/app/services/background_tasks.py:221]
2025-08-23 14:50:18,293 INFO: ü§ñ USING LANGCHAIN PIPELINE for custom subject: 'custom_therapy_demo-user' [in /app/app/services/background_tasks.py:225]
2025-08-23 14:50:18,294 INFO: Environment validation passed [in /app/app/services/langchain_base.py:277]
2025-08-23 14:50:18,295 INFO: Environment validation passed [in /app/app/services/langchain_base.py:277]
2025-08-23 14:50:18,297 INFO: Initialized SurveyGenerationChain with temperature=0.8, max_tokens=2000 [in /app/app/services/langchain_chains.py:27]
2025-08-23 14:50:18,298 INFO: Environment validation passed [in /app/app/services/langchain_base.py:277]
2025-08-23 14:50:18,300 INFO: Initialized CurriculumGeneratorChain with temperature=0.7, max_tokens=3000 [in /app/app/services/langchain_chains.py:27]
2025-08-23 14:50:18,301 INFO: Environment validation passed [in /app/app/services/langchain_base.py:277]
2025-08-23 14:50:18,302 INFO: Initialized LessonPlannerChain with temperature=0.7, max_tokens=1200 [in /app/app/services/langchain_chains.py:27]
2025-08-23 14:50:18,304 INFO: Environment validation passed [in /app/app/services/langchain_base.py:277]
2025-08-23 14:50:18,305 INFO: Initialized ContentGeneratorChain with temperature=0.6, max_tokens=4000 [in /app/app/services/langchain_chains.py:27]
2025-08-23 14:50:18,306 INFO: LangChain pipeline service initialized [in /app/app/services/langchain_pipeline.py:29]
2025-08-23 14:50:18,308 INFO: üöÄ STARTING LANGCHAIN FULL PIPELINE... [in /app/app/services/background_tasks.py:229]
2025-08-23 14:50:18,309 INFO: Starting full LangChain pipeline for custom_therapy_demo-user, curriculum_only=False [in /app/app/services/langchain_pipeline.py:105]
2025-08-23 14:50:18,311 INFO: Pipeline Stage 1: Generating curriculum [in /app/app/services/langchain_pipeline.py:112]
2025-08-23 14:50:18,312 INFO: Starting Stage 1: Curriculum generation for custom_therapy_demo-user [in /app/app/services/langchain_pipeline.py:65]
2025-08-23 14:50:18,313 INFO: Starting curriculum generation for custom_therapy_demo-user [in /app/app/services/langchain_chains.py:523]
2025-08-23 14:50:33,304 INFO: Successfully generated curriculum with 10 lessons for custom_therapy_demo-user [in /app/app/services/langchain_chains.py:569]
2025-08-23 14:50:33,306 INFO: Stage 1 completed: Curriculum generated for custom_therapy_demo-user [in /app/app/services/langchain_pipeline.py:69]
2025-08-23 14:50:33,308 INFO: Pipeline Stage 2: Generating lesson plans [in /app/app/services/langchain_pipeline.py:129]
2025-08-23 14:50:33,309 INFO: Starting Stage 2: Lesson planning for custom_therapy_demo-user [in /app/app/services/langchain_pipeline.py:78]
2025-08-23 14:50:33,311 INFO: Starting lesson plan generation for custom_therapy_demo-user [in /app/app/services/langchain_chains.py:724]
2025-08-23 14:50:43,593 ERROR: Failed to parse JSON from LLM output: Expecting ',' delimiter: line 12 column 10 (char 594) [in /app/app/services/langchain_base.py:191]
